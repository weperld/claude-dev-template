# Gate 검증 시스템

> 각 개발 단계 간 전환 시 품질을 보장하기 위한 검증 게이트 시스템입니다.

---

## 1단계: 기획서 유형 분석

### 유형 A: 기능 수정 (Feature Fix/Enhancement)

**판단 기준:**
- ✅ 기존 기능의 버그 수정
- ✅ 기존 기능의 성능 개선
- ✅ 기존 기능의 사용성 개선
- ✅ 리팩토링 (기능 변화 없음)
- ✅ 호환성 이슈 수정

**분석 체크리스트:**
- [ ] 영향받는 Feature ID 확인
- [ ] 영향받는 파일 목록
- [ ] 영향받는 UI 요소
- [ ] 호환성 고려사항
- [ ] 기존 데이터 호환성 여부
- [ ] 테스트 방법

**자동 판단 키워드:**
- "버그", "오류", "수정", "개선", "최적화", "리팩토링"

---

### 유형 B: 새로운 기능 추가 (New Feature)

**판단 기준:**
- ✅ 완전히 새로운 카테고리
- ✅ 기존 카테고리의 새로운 컴포넌트
- ✅ 새로운 UI 요소 추가
- ✅ 새로운 데이터 모델 필요
- ✅ 새로운 API 추가

**분석 체크리스트:**
- [ ] 필요한 카테고리 결정 {{FEATURE_CATEGORIES}}
- [ ] 새로운 컴포넌트 필요 여부
- [ ] 새로운 ViewModel 필요 여부
- [ ] 새로운 View 필요 여부
- [ ] 설정 요구사항
- [ ] 템플릿 요구사항
- [ ] UI 흐름

**자동 판단 키워드:**
- "신규", "추가", "생성", "새로운", "기능"

---

## 2단계: 계획 수립

### 🚪 검증 게이트 시스템

```
{{GATED_PIPELINE_ARROW}}
```

#### 검증 게이트 개요

| 게이트 | 검증 대상 | 자체 더블체크 | 크로스체크 에이전트 | 실패 시 롤백 |
|--------|----------|---------------|---------------------|--------------|
{{GATE_OVERVIEW_TABLE}}

#### 게이트 통과 조건

{{GATE_DETAILS}}

---

### 🔄 수렴 검증 프로토콜

분석/계획/설계 단계에서는 **반복적 수렴 점검**을 수행합니다.
결과물에 누락·모호·위험 요소(필수 보완 사항)가 0건이 될 때까지 점검→반영을 반복하며,
선택적 보완 사항만 남으면 Gate로 진행합니다.

> 이 프로토콜은 "개선" 작업에만 해당하는 것이 아니라, **모든 계획/설계 작업**에서
> 결과물의 완전성과 견고성을 확보하기 위한 표준 프로세스입니다.

#### 수렴 프로세스

```
┌─────────────────────────────────────────────┐
│  1. 초기 작업 수행 (분석/계획/설계)         │
└──────────────────┬──────────────────────────┘
                   ▼
┌─────────────────────────────────────────────┐
│  2. 결과물 점검: 보완 사항 도출             │◄──┐
│     - 누락된 항목, 모호한 정의, 위험 요소   │   │
│     - 구조적 결함, 성능 우려, 확장성 이슈   │   │
│     - 미식별 의존성, 불완전한 분석          │   │
└──────────────────┬──────────────────────────┘   │
                   ▼                               │
┌─────────────────────────────────────────────┐   │
│  3. 보완 사항 분류                          │   │
│     - 필수(MUST): 미해결 시 후속 단계에서   │   │
│       문제 발생 또는 재작업 필요            │   │
│     - 선택(OPTIONAL): 품질 향상에 기여하나  │   │
│       현재 진행에 지장 없음                 │   │
└──────────────────┬──────────────────────────┘   │
                   ▼                               │
           ┌──────────────┐                        │
           │ 필수 > 0건?  │── YES ── 반영 후 ──────┘
           └──────┬───────┘
                  │ NO
                  ▼
┌─────────────────────────────────────────────┐
│  4. 수렴 완료                               │
│     - 잔존 선택 보완 사항 목록 기록         │
│     - Gate 검증으로 진행                    │
└─────────────────────────────────────────────┘
```

#### 분류 기준

| 구분 | 기준 | 예시 |
|------|------|------|
| **필수** | 미해결 시 후속 단계에서 문제/재작업 발생 | 누락된 영향 파일, 모호한 인터페이스 정의, 미식별 의존성, 보안 취약 설계, 불완전한 위험 분석 |
| **선택** | 품질 향상에 기여하나 현재 진행에 지장 없음 | 코드 스타일 선호도, 추가 문서화, 미래 확장성 고려, 대안 아키텍처 검토 |

#### 수렴 기록 형식

각 수렴 반복 시 다음을 기록합니다:

```
### 수렴 반복 #N
- **발견된 보완 사항**: X건 (필수 Y건 / 선택 Z건)
- **필수 보완 사항**:
  1. [내용] → [반영 방법]
  2. ...
- **선택 보완 사항**:
  1. [내용] → [선택으로 분류한 근거]
  2. ...
- **결과**: 필수 보완 사항 반영 완료 / 수렴 달성
```

#### 적용 대상 단계

수렴 검증은 다음 단계에 적용됩니다 (stages.json의 `"convergence": true`):
- **Plan (계획)**: 분석 결과와 작업 계획의 완전성·견고성 수렴
- **Design (설계)**: 아키텍처 설계의 기술적 완전성·견고성 수렴

> 구현(Code) 이후 단계는 Gate 검증과 크로스체크로 품질을 보장하므로 수렴 점검을 적용하지 않습니다.

---

### 기능 수정 계획 템플릿

```markdown
## 📋 기능 수정 계획

### 문제 정의
- **현재 동작**: ...
- **예상 동작**: ...
- **발생 상황**: ...

### 수정 범위
- **영향 파일**:
  - {{PROJECT_FILE_STRUCTURE}}
- **수정 라인**: ...
- **테스트 방법**: ...

### 위험 요소
- [ ] 호환성 문제
- [ ] 데이터 무결성 영향
- [ ] 성능 영향

### 검증 계획
- **더블체크 계획**: 1차 검증 후 2차 검증
- **크로스체크 에이전트**: architect

### 예상 소요 시간
...

### 우선순위
- [ ] High
- [ ] Medium
- [ ] Low
```

---

### 새로운 기능 계획 템플릿

```markdown
## 📋 새로운 기능 추가 계획

### 기능 개요
- **기능 이름**: ...
- **카테고리**: {{FEATURE_CATEGORIES}}
- **설명**: ...

### 구현 파일
{{PROJECT_FILE_STRUCTURE}}

### 설정
- **필요한 경로 설정**: ...
- **필요한 템플릿**: ...

### UI 변경사항
- **새로운 화면**: ...
- **기존 화면 수정**: ...

### 구현 순서
1. Model 정의
2. 핵심 로직 구현
3. ViewModel 생성
4. View 생성
5. 통합
6. 테스트

### 위험 요소
...

### 검증 계획
- **더블체크 계획**: 각 단계별 1차, 2차 검증
- **크로스체크 에이전트**: architect (Gate-2), reviewer (Gate-3), developer (Gate-4)

### 예상 소요 시간
...
```

---

## 3단계: 사용자 확인

### 확인 형식

```
✅ 계획이 수립되었습니다.

[WorkID]: WIP-YYYYMMDD-NNN
[유형]: (기능 수정 / 새로운 기능)

[계획 요약]
...

[영향 파일]
...

[위험 요소]
...

진행하시겠습니까? (y/n 또는 수정 요청)
```

### 확인 대기 시 에이전트 동작
- 사용자 "y" → 즉시 구현 시작
- 사용자 "n" → 취소 사유 문의
- 사용자 "수정 요청" → 계획 수정 후 재확인

---

## 📚 관련 모듈

- [PIPELINE.md](PIPELINE.md) - 개발 파이프라인
- [AUTO_UPDATE.md](AUTO_UPDATE.md) - WorkID 및 자동 업데이트 시스템
- [ERROR_HANDLING.md](ERROR_HANDLING.md) - 에러 처리 및 롤백 프로토콜
